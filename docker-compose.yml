version: '2'
services:
    db:
        build: mysql
        hostname: reddb
        container_name: reddb
        environment:
            MYSQL_ROOT_PASSWORD: password
        expose:
            - 3306
        volumes:
            - /APL/share:/APL/share
            - /mysql/data:/var/lib/mysql
    redmine:
        build: redmine-debian
        hostname: redapp
        container_name: redapp
        volumes:
            - /APL/share:/APL/share
            - /APL/tradestar:/var/www/redmine/plugins/tradestar
            - /APL/docker/redmine/var/www/redmine/plugins:/var/www/redmine/plugins
        ports:
            - 80:3000
        links:
            - db
            - mmsite
        command: bash -c 'while true; do sleep 10; done'
    mmsite:
        build: mattermost
        hostname: mmsite
        container_name: mmsite
        volumes:
            - /APL/share:/APL/share
        ports:
            - 81:80
        links:
            - db
        #command: bash -c 'while true; do sleep 10; done'
